# PCR结果分析软件 - 使用说明

## 快速开始

### 方式一：直接运行（推荐）

1. 双击 `run.bat` 文件启动程序

### 方式二：命令行运行

```bash
python pcr_analyzer.py
```

## 功能说明

### 1. 打开Excel文件

- 点击工具栏的"打开Excel文件"按钮
- 选择PCR结果Excel文件（支持.xlsx和.xls格式）
- 程序会自动识别文件格式并解析

### 2. 查看实验数据

在"实验数据"标签页可以查看：
- **实验信息**：开始时间、结束时间、实验名称等
- **数据表格**：解析后的PCR数据，包括各通道的Ct值或荧光值

### 3. 查看扩增曲线

在"扩增曲线"标签页可以查看：
- **可视化图表**：各通道的PCR扩增曲线
- 支持多个通道同时显示（如HEX、CY5、ROX等）

### 4. 导出结果

- 点击"导出结果"按钮
- 选择保存位置
- 结果将保存为Excel格式

## 支持的Excel格式

程序目前支持以下格式：

### 格式A（示例文件格式）
- 包含"实验数据"和"扩增曲线"两个工作表
- 扩增曲线工作表中包含通道信息（HEX、CY5、ROX等）
- 数据按行排列，每行代表一个循环数

### 标准格式
- 包含通道名称行（如HEX、CY5、ROX等）
- 数据区域清晰可识别
- 支持NoCt、N/A等特殊值

## 常见问题

### Q: 程序无法识别我的Excel格式？
A: 可以在`excel_parser.py`中添加自定义解析器，参考`VendorAParser`的实现方式。

### Q: 扩增曲线显示不正确？
A: 请检查Excel文件中的数据格式，确保：
- 通道名称清晰可识别
- 数据值格式正确（数字或NoCt等）
- 循环数信息存在

### Q: 如何添加新的厂商格式支持？
A: 
1. 创建新的解析器类（继承`BaseParser`）
2. 在`ExcelParser`中注册新解析器
3. 实现`detect_vendor`方法以自动识别格式

## 技术架构

- **界面框架**: PyQt5
- **数据处理**: pandas, numpy
- **Excel解析**: openpyxl
- **数据可视化**: matplotlib

## 打包为exe

如果需要打包为独立的exe文件：

```bash
pip install pyinstaller
python build_exe.py
```

打包后的文件在`dist`目录中。

## 注意事项

1. 确保Excel文件格式正确
2. 首次运行可能需要安装依赖包
3. 建议使用Python 3.8或更高版本

